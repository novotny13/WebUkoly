<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://code.jquery.com/jquery-3.5.0.js"></script>
    <link rel="stylesheet" href="style.css">
    <title>Kafe</title>
    <script>
        $(document).ready(function () {
         $.ajax({
            url: 'http://ajax1.lmsoft.cz/procedure.php?cmd=getPeopleList',
            beforeSend: function (xhr) {
                xhr.setRequestHeader("Authorization", "Basic " + btoa("coffee:kafe"));
},
                 type: "POST",
                 
                 dataType: 'JSON',
                 contentType: 'application/json',
                 processData: false,
                 success: generateButtons
             });

             $.ajax({
            url: 'http://ajax1.lmsoft.cz/procedure.php?cmd=getTypesList',
            beforeSend: function (xhr) {
                xhr.setRequestHeader("Authorization", "Basic " + btoa("coffee:kafe"));
},
                 type: "POST",
                 
                 dataType: 'JSON',
                 contentType: 'application/json',
                 processData: false,
                 success: generateSliders
             });
 
 
        })
         function generateButtons(data){
             $.each(data, function (key, value) {
                 $("#namesRadio").append(
                     `<div><input type="radio" id="name${key}" name="user" value="${value.ID}">
                     <label for="name${key}">${value.name}</label></div>`
                 );
             });
         }
 
    
         function generateSliders(data) {
             $.each(data, function (key, value) {
                 $("#typesSliders").append(
                     `<div class='sliderDiv'>
                         <label for='slider${key}'>${value.typ}</label>
                         <div class='sliderDiv'>
                             <label id='slidertext${key}'>0</label>
                             <input type='range' min='0' max='10' value='0' class='slider' id='slider${key}'>
                         </div>
                     </div>`
                 );
 
                 let slider = document.getElementById("slider" + key);
                 slider.addEventListener("input", function () {
                     document.getElementById("slidertext" + key).innerText = slider.value;
                 });
             });
         }
 
        
         function showList(event) {
             event.preventDefault();
 
             $.get("http://ajax1.lmsoft.cz/procedure.php?cmd=getSummaryOfDrinks", function (data) {
                 $("#table").remove(); 
                 $("body").append("<table id='table'><tr><th>Název</th><th>Jméno</th><th>Počet</th></tr></table>");
 
                 $.each(data, function (key, value) {
                     $("#table").append(`<tr><td>${value[0]}</td><td>${value[2]}</td><td>${value[1]}</td></tr>`);
                 });
             }).fail(function () {
                 alert("Cannot get summary data");
             }).beforeSend(function (xhr) {
                 xhr.setRequestHeader("Authorization", "Basic " + btoa("coffee:kafe"));
             });
         }
     </script>
    <style>
        body {
            font-family: Arial, sans-serif;
            margin: 20px;
        }

        #form {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
            border: 1px solid #ccc;
            border-radius: 10px;
            background-color: #f9f9f9;
        }

        .sliderDiv {
            margin-bottom: 10px;
        }

        input[type="submit"], #listButton {
            background-color: #4CAF50;
            color: white;
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            margin-top: 10px;
        }

        input[type="submit"]:hover, #listButton:hover {
            background-color: #45a049;
        }

        table {
            margin-top: 20px;
            width: 100%;
            border-collapse: collapse;
        }

        table, th, td {
            border: 1px solid black;
        }

        th, td {
            padding: 8px;
            text-align: left;
        }

        th {
            background-color: #f2f2f2;
        }
    </style>
</head>

<body>
    <h1>Evidence vypité kávy</h1>

    <form id="form">
        <div id="namesRadio" class="emptyDiv"></div>
        <br>
        <div id="typesSliders" class="emptyDiv"></div>

        <div>
            <input type="submit" value="Odeslat">
            <button type="button" id="listButton">Seznam použití</button>
        </div>
    </form>

    
</body>

</html>
